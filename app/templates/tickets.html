{% extends "base.html" %}
{# Как и раньше — используем общий шаблон base.html #}

{% block content %}
  <div class="d-flex align-items-center mb-3">
    <h3 class="mb-0">Заявки</h3>
    {# Заголовок страницы — «Заявки» #}

    <span class="ms-3 text-muted">Вы: {{ current_user.username }} ({{ current_user.role }})</span>
    {# Показываем имя залогиненного пользователя и его роль. #}
  </div>

  <form method="post" class="mb-4">
    {# Форма для создания новой заявки.
       method="post" — данные отправляются на тот же маршрут /tickets. #}

    <div class="row g-2">
      {# Блок разметки Bootstrap: одна строка с несколькими колонками. #}

      <div class="col-md-4">
        <input type="text" name="title" class="form-control" placeholder="Название заявки" required>
        {# Поле ввода названия заявки. #}
      </div>

      <div class="col-md-6">
        <input type="text" name="description" class="form-control" placeholder="Описание">
        {# Поле ввода описания заявки. Не обязательно для заполнения. #}
      </div>

      <div class="col-md-2 d-grid">
        <button class="btn btn-success">Создать</button>
        {# Кнопка создания новой заявки. #}
      </div>
    </div>
  </form>

  <table class="table table-striped table-bordered">
    {# Таблица для отображения всех заявок.
       table-striped — полосатые строки,
       table-bordered — с рамками. #}

    <thead class="table-light">
      <tr>
        <th>ID</th>
        <th>Название</th>
        <th>Статус</th>
        <th>Автор</th>
      </tr>
    </thead>

    <tbody>
      {% for t in tickets %}
      {# Цикл — перебираем все заявки, переданные с сервера в переменной tickets. #}

        <tr>
          <td>{{ t.id }}</td>
          {# Выводим номер заявки. #}

          <td><a href="{{ url_for('web.ticket_detail', ticket_id=t.id) }}">{{ t.title }}</a></td>
          {# Название заявки, которое является ссылкой на страницу с подробностями. #}

          <td>{{ t.status }}</td>
          {# Статус заявки. #}

          <td>{{ t.author.username }}</td>
          {# Имя пользователя, который создал эту заявку. #}
        </tr>

      {% else %}
      {# Если в списке tickets нет ни одной заявки, выполняется этот блок #}

        <tr>
          <td colspan="4" class="text-center text-muted">Заявок пока нет</td>
        </tr>

      {% endfor %}
    </tbody>
  </table>

{% endblock %}
